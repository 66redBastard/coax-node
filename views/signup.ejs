<%- include('partials/header'); -%>
	<div class="mx-auto mt-5" style="width: 420px;">
		<h3 class="mb-5">SignUp Page</h3>
		<form action="/signup">
			<div class="mb-3">
				<label for="firstName" class="form-label">First Name</label>
				<input type="text" class="form-control" id="firstName">
			</div>
			<div class="mb-3">
				<label for="lastName" class="form-label">Last Name</label>
				<input type="text" class="form-control" id="lastName">
			</div>
			<div class="mb-3">
				<label for="email" class="form-label">Email address</label>
				<input type="email" class="form-control" id="email"
					aria-describedby="emailHelp">
				<div id="emailHelp" class="form-text">We'll never share your
					email with
					anyone else.</div>
				<div class="email error"></div>
			</div>
			<div class="mb-3">
				<label for="password" class="form-label">Password</label>
				<input type="password" class="form-control" id="password">
				<div class="password error"></div>
			</div>
			<button type="submit"
				class="btn btn-outline-primary">Submit</button>
		</form>
	</div>
	<script>
		const form = document.querySelector('form');
		const emailError = document.querySelector('.email.error');
		const passwordError = document.querySelector('.password.error');
		form.addEventListener('submit', async (e) => {
			e.preventDefault();
			// reset errors
			emailError.textContent = '';
			passwordError.textContent = '';
			// get values
			const firstName = form.firstName.value;
			const lastName = form.lastName.value;
			const email = form.email.value;
			const password = form.password.value;
			try {
				const res = await fetch('/signup', {
					method: 'POST',
					body: JSON.stringify({ first_name: firstName, last_name: lastName, email: email, password: password }),
					headers: { 'Content-Type': 'application/json' }
				});
				const data = await res.json();
				console.log(data);
				if (data.errors) {
					emailError.textContent = data.errors.email;
					passwordError.textContent = data.errors.password;
				}
				location.assign('/login');
			}
			catch (err) {
				console.log(err);
			}
		});
	</script>

	<%- include('partials/footer'); -%>